(function(){function e(t,n,r){var i=e.resolve(t);if(null==i){r=r||t,n=n||"root";var s=new Error('Failed to require "'+r+'" from "'+n+'"');throw s.path=r,s.parent=n,s.require=!0,s}var o=e.modules[i];return o.exports||(o.exports={},o.client=o.component=!0,o.call(this,o.exports,e.relative(i),o)),o.exports}e.modules={},e.aliases={},e.resolve=function(t){t.charAt(0)==="/"&&(t=t.slice(1));var n=[t,t+".js",t+".json",t+"/index.js",t+"/index.json"];for(var r=0;r<n.length;r++){var t=n[r];if(e.modules.hasOwnProperty(t))return t;if(e.aliases.hasOwnProperty(t))return e.aliases[t]}},e.normalize=function(e,t){var n=[];if("."!=t.charAt(0))return t;e=e.split("/"),t=t.split("/");for(var r=0;r<t.length;++r)".."==t[r]?e.pop():"."!=t[r]&&""!=t[r]&&n.push(t[r]);return e.concat(n).join("/")},e.register=function(t,n){e.modules[t]=n},e.alias=function(t,n){if(!e.modules.hasOwnProperty(t))throw new Error('Failed to alias "'+t+'", it does not exist');e.aliases[n]=t},e.relative=function(t){function r(e,t){var n=e.length;while(n--)if(e[n]===t)return n;return-1}function i(n){var r=i.resolve(n);return e(r,t,n)}var n=e.normalize(t,"..");return i.resolve=function(i){var s=i.charAt(0);if("/"==s)return i.slice(1);if("."==s)return e.normalize(n,i);var o=t.split("/"),u=r(o,"deps")+1;return u||(u=0),i=o.slice(0,u+1).join("/")+"/deps/"+i,i},i.exists=function(t){return e.modules.hasOwnProperty(i.resolve(t))},i},e.register("lodash-lodash/index.js",function(e,t,n){n.exports=t("./dist/lodash.compat.js")}),e.register("lodash-lodash/dist/lodash.compat.js",function(e,t,n){(function(){function $(e,t,n){var r=(n||0)-1,i=e?e.length:0;while(++r<i)if(e[r]===t)return r;return-1}function J(e,t){var n=typeof t;e=e.cache;if(n=="boolean"||t==null)return e[t]?0:-1;n!="number"&&n!="string"&&(n="object");var r=n=="number"?t:u+t;return e=(e=e[n])&&e[r],n=="object"?e&&$(e,t)>-1?0:-1:e?0:-1}function K(e){var t=this.cache,n=typeof e;if(n=="boolean"||e==null)t[e]=!0;else{n!="number"&&n!="string"&&(n="object");var r=n=="number"?e:u+e,i=t[n]||(t[n]={});n=="object"?(i[r]||(i[r]=[])).push(e):i[r]=!0}}function Q(e){return e.charCodeAt(0)}function G(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||typeof n=="undefined")return 1;if(n<r||typeof r=="undefined")return-1}return e.index-t.index}function Y(e){var t=-1,n=e.length,r=e[0],i=e[n/2|0],s=e[n-1];if(r&&typeof r=="object"&&i&&typeof i=="object"&&s&&typeof s=="object")return!1;var o=tt();o["false"]=o["null"]=o["true"]=o["undefined"]=!1;var u=tt();u.array=e,u.cache=o,u.push=K;while(++t<n)u.push(e[t]);return u}function Z(e){return"\\"+R[e]}function et(){return r.pop()||[]}function tt(){return i.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,"undefined":!1,value:null}}function nt(e){return typeof e.toString!="function"&&typeof (e+"")=="string"}function rt(e){e.length=0,r.length<f&&r.push(e)}function it(e){var t=e.cache;t&&it(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,i.length<f&&i.push(e)}function st(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1,i=n-t||0,s=Array(i<0?0:i);while(++r<i)s[r]=e[t+r];return s}function ot(e){function Ut(e){return e&&typeof e=="object"&&!pn(e)&&xt.call(e,"__wrapped__")?e:new zt(e)}function zt(e,t){this.__chain__=!!t,this.__wrapped__=e}function Vt(e){function i(){if(n){var e=n.slice();Nt.apply(e,arguments)}if(this instanceof i){var s=Jt(t.prototype),o=t.apply(s,e||arguments);return Xn(o)?o:s}return t.apply(r,e||arguments)}var t=e[0],n=e[2],r=e[4];return fn(i,e),i}function $t(e,t,n,r,i){if(n){var s=n(e);if(typeof s!="undefined")return s}var o=Xn(e);if(!o)return e;var u=mt.call(e);if(!B[u]||!Wt.nodeClass&&nt(e))return e;var a=qt[u];switch(u){case L:case A:return new a(+e);case _:case H:return new a(e);case P:return s=a(e.source,v.exec(e)),s.lastIndex=e.lastIndex,s}var f=pn(e);if(t){var l=!r;r||(r=et()),i||(i=et());var c=r.length;while(c--)if(r[c]==e)return i[c];s=f?a(e.length):{}}else s=f?st(e):Tn({},e);return f&&(xt.call(e,"index")&&(s.index=e.index),xt.call(e,"input")&&(s.input=e.input)),t?(r.push(e),i.push(s),(f?xn:Dn)(e,function(e,o){s[o]=$t(e,t,n,r,i)}),l&&(rt(r),rt(i)),s):s}function Jt(e,t){return Xn(e)?Mt(e):{}}function Kt(e,t,n){if(typeof e!="function")return vi;if(typeof t!="undefined"&&"prototype"in e){var r=e.__bindData__;if(typeof r=="undefined"){Wt.funcNames&&(r=!e.name),r=r||!Wt.funcDecomp;if(!r){var i=Et.call(e);Wt.funcNames||(r=!m.test(i)),r||(r=w.test(i),fn(e,r))}}if(r===!1||r!==!0&&r[1]&1)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return Zr(e,t)}return e}function Qt(e){function h(){var e=u?s:this;if(r){var p=r.slice();Nt.apply(p,arguments)}if(i||f){p||(p=st(arguments)),i&&Nt.apply(p,i);if(f&&p.length<o)return n|=16,Qt([t,l?n:n&-4,p,null,s,o])}p||(p=arguments),a&&(t=e[c]);if(this instanceof h){e=Jt(t.prototype);var d=t.apply(e,p);return Xn(d)?d:e}return t.apply(e,p)}var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=n&1,a=n&2,f=n&4,l=n&8,c=t;return fn(h,e),h}function Gt(e,t){var n=-1,r=an(),i=e?e.length:0,s=i>=a&&r===$,o=[];if(s){var u=Y(t);u?(r=J,t=u):s=!1}while(++n<i){var f=e[n];r(t,f)<0&&o.push(f)}return s&&it(t),o}function Yt(e,t,n,r){var i=(r||0)-1,s=e?e.length:0,o=[];while(++i<s){var u=e[i];if(u&&typeof u=="object"&&typeof u.length=="number"&&(pn(u)||hn(u))){t||(u=Yt(u,t,n));var a=-1,f=u.length,l=o.length;o.length+=f;while(++a<f)o[l++]=u[a]}else n||o.push(u)}return o}function Zt(e,t,n,r,i,s){if(n){var o=n(e,t);if(typeof o!="undefined")return!!o}if(e===t)return e!==0||1/e==1/t;var u=typeof e,a=typeof t;if(e===e&&(!e||!q[u])&&(!t||!q[a]))return!1;if(e==null||t==null)return e===t;var f=mt.call(e),l=mt.call(t);f==N&&(f=D),l==N&&(l=D);if(f!=l)return!1;switch(f){case L:case A:return+e==+t;case _:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case P:case H:return e==ft(t)}var c=f==C;if(!c){var h=xt.call(e,"__wrapped__"),p=xt.call(t,"__wrapped__");if(h||p)return Zt(h?e.__wrapped__:e,p?t.__wrapped__:t,n,r,i,s);if(f!=D||!Wt.nodeClass&&(nt(e)||nt(t)))return!1;var d=!Wt.argsObject&&hn(e)?K:e.constructor,v=!Wt.argsObject&&hn(t)?K:t.constructor;if(d!=v&&!(Wn(d)&&d instanceof d&&Wn(v)&&v instanceof v)&&"constructor"in e&&"constructor"in t)return!1}var m=!i;i||(i=et()),s||(s=et());var g=i.length;while(g--)if(i[g]==e)return s[g]==t;var y=0;o=!0,i.push(e),s.push(t);if(c){g=e.length,y=t.length,o=y==e.length;if(!o&&!r)return o;while(y--){var b=g,w=t[y];if(r){while(b--)if(o=Zt(e[b],w,n,r,i,s))break}else if(!(o=Zt(e[y],w,n,r,i,s)))break}return o}return Mn(t,function(t,u,a){if(xt.call(a,u))return y++,o=xt.call(e,u)&&Zt(e[u],t,n,r,i,s)}),o&&!r&&Mn(e,function(e,t,n){if(xt.call(n,t))return o=--y>-1}),m&&(rt(i),rt(s)),o}function en(e,t,n,r,i){(pn(t)?hr:Dn)(t,function(t,s){var o,u,a=t,f=e[s];if(t&&((u=pn(t))||Kn(t))){var l=r.length;while(l--)if(o=r[l]==t){f=i[l];break}if(!o){var c;if(n){a=n(f,t);if(c=typeof a!="undefined")f=a}c||(f=u?pn(f)?f:[]:Kn(f)?f:{}),r.push(t),i.push(f),c||en(f,t,n,r,i)}}else n&&(a=n(f,t),typeof a=="undefined"&&(a=t)),typeof a!="undefined"&&(f=a);e[s]=f})}function tn(e,t){return e+wt(It()*(t-e+1))}function nn(e,t,n){var r=-1,i=an(),s=e?e.length:0,o=[],u=!t&&s>=a&&i===$,f=n||u?et():o;if(u){var l=Y(f);l?(i=J,f=l):(u=!1,f=n?f:(rt(f),o))}while(++r<s){var c=e[r],h=n?n(c,r,e):c;if(t?!r||f[f.length-1]!==h:i(f,h)<0)(n||u)&&f.push(h),o.push(c)}return u?(rt(f.array),it(f)):n&&rt(f),o}function rn(e){return function(t,n,r){var i={};n=Ut.createCallback(n,r,3);if(pn(t)){var s=-1,o=t.length;while(++s<o){var u=t[s];e(i,u,n(u,s,t),t)}}else xn(t,function(t,r,s){e(i,t,n(t,r,s),s)});return i}}function sn(e,t,n,r,i,s){var o=t&1,u=t&2,a=t&4,f=t&8,l=t&16,c=t&32;if(!u&&!Wn(e))throw new lt;l&&!n.length&&(t&=-17,l=n=!1),c&&!r.length&&(t&=-33,c=r=!1);var h=e&&e.__bindData__;if(h&&h!==!0)return h=h.slice(),o&&!(h[1]&1)&&(h[4]=i),!o&&h[1]&1&&(t|=8),a&&!(h[1]&4)&&(h[5]=s),l&&Nt.apply(h[2]||(h[2]=[]),n),c&&Nt.apply(h[3]||(h[3]=[]),r),h[1]|=t,sn.apply(null,h);var p=t==1||t===17?Vt:Qt;return p([e,t,n,r,i,s])}function on(){I.shadowedProps=x,I.array=I.bottom=I.loop=I.top="",I.init="iterable",I.useHas=!0;for(var e,t=0;e=arguments[t];t++)for(var n in e)I[n]=e[n];var r=I.args;I.firstArg=/^[^,]+/.exec(r)[0];var i=R("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+r+") {\n"+Xt(I)+"\n}");return i(Kt,O,ht,xt,o,hn,pn,Gn,I.keys,pt,q,Rt,H,dt,mt)}function un(e){return bn[e]}function an(){var e=(e=Ut.indexOf)===jr?$:e;return e}function ln(e){var t,n;return!e||mt.call(e)!=D||(t=e.constructor,Wn(t)&&!(t instanceof t))||!Wt.argsClass&&hn(e)||!Wt.nodeClass&&nt(e)?!1:Wt.ownLast?(Mn(e,function(e,t,r){return n=xt.call(r,t),!1}),n!==!1):(Mn(e,function(e,t){n=t}),typeof n=="undefined"||xt.call(e,n))}function cn(e){return wn[e]}function hn(e){return e&&typeof e=="object"&&typeof e.length=="number"&&mt.call(e)==N||!1}function Nn(e,t,n,r){return typeof t!="boolean"&&t!=null&&(r=n,n=t,t=!1),$t(e,t,typeof n=="function"&&Kt(n,r,1))}function Cn(e,t,n){return $t(e,!0,typeof t=="function"&&Kt(t,n,1))}function kn(e,t){var n=Jt(e);return t?Tn(n,t):n}function An(e,t,n){var r;return t=Ut.createCallback(t,n,3),Dn(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function On(e,t,n){var r;return t=Ut.createCallback(t,n,3),Pn(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function _n(e,t,n){var r=[];Mn(e,function(e,t){r.push(t,e)});var i=r.length;t=Kt(t,n,3);while(i--)if(t(r[i--],r[i],e)===!1)break;return e}function Pn(e,t,n){var r=vn(e),i=r.length;t=Kt(t,n,3);while(i--){var s=r[i];if(t(e[s],s,e)===!1)break}return e}function Hn(e){var t=[];return Mn(e,function(e,n){Wn(e)&&t.push(n)}),t.sort()}function Bn(e,t){return e?xt.call(e,t):!1}function jn(e){var t=-1,n=vn(e),r=n.length,i={};while(++t<r){var s=n[t];i[e[s]]=s}return i}function Fn(e){return e===!0||e===!1||e&&typeof e=="object"&&mt.call(e)==L||!1}function In(e){return e&&typeof e=="object"&&mt.call(e)==A||!1}function qn(e){return e&&e.nodeType===1||!1}function Rn(e){var t=!0;if(!e)return t;var n=mt.call(e),r=e.length;return n==C||n==H||(Wt.argsClass?n==N:hn(e))||n==D&&typeof r=="number"&&Wn(e.splice)?!r:(Dn(e,function(){return t=!1}),t)}function Un(e,t,n,r){return Zt(e,t,typeof n=="function"&&Kt(n,r,2))}function zn(e){return Dt(e)&&!Pt(parseFloat(e))}function Wn(e){return typeof e=="function"}function Xn(e){return!!e&&!!q[typeof e]}function Vn(e){return Jn(e)&&e!=+e}function $n(e){return e===null}function Jn(e){return typeof e=="number"||e&&typeof e=="object"&&mt.call(e)==_||!1}function Qn(e){return e&&q[typeof e]&&mt.call(e)==P||!1}function Gn(e){return typeof e=="string"||e&&typeof e=="object"&&mt.call(e)==H||!1}function Yn(e){return typeof e=="undefined"}function Zn(e){var t=arguments,n=2;if(!Xn(e))return e;typeof t[2]!="number"&&(n=t.length);if(n>3&&typeof t[n-2]=="function")var r=Kt(t[--n-1],t[n--],2);else n>2&&typeof t[n-1]=="function"&&(r=t[--n]);var i=st(arguments,1,n),s=-1,o=et(),u=et();while(++s<n)en(e,i[s],r,o,u);return rt(o),rt(u),e}function er(e,t,n){var r={};if(typeof t!="function"){var i=[];Mn(e,function(e,t){i.push(t)}),i=Gt(i,Yt(arguments,!0,!1,1));var s=-1,o=i.length;while(++s<o){var u=i[s];r[u]=e[u]}}else t=Ut.createCallback(t,n,3),Mn(e,function(e,n,i){t(e,n,i)||(r[n]=e)});return r}function tr(e){var t=-1,r=vn(e),i=r.length,s=n(i);while(++t<i){var o=r[t];s[t]=[o,e[o]]}return s}function nr(e,t,n){var r={};if(typeof t!="function"){var i=-1,s=Yt(arguments,!0,!1,1),o=Xn(e)?s.length:0;while(++i<o){var u=s[i];u in e&&(r[u]=e[u])}}else t=Ut.createCallback(t,n,3),Mn(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r}function rr(e,t,n,r){var i=pn(e);if(n==null)if(i)n=[];else{var s=e&&e.constructor,o=s&&s.prototype;n=Jt(o)}return t&&(t=Ut.createCallback(t,r,4),(i?xn:Dn)(e,function(e,r,i){return t(n,e,r,i)})),n}function ir(e){var t=-1,r=vn(e),i=r.length,s=n(i);while(++t<i)s[t]=e[r[t]];return s}function sr(e){var t=arguments,r=-1,i=Yt(t,!0,!1,1),s=t[2]&&t[2][t[1]]===e?1:i.length,o=n(s);Wt.unindexedChars&&Gn(e)&&(e=e.split(""));while(++r<s)o[r]=e[i[r]];return o}function or(e,t,n){var r=-1,i=an(),s=e?e.length:0,o=!1;return n=(n<0?Bt(0,s+n):n)||0,pn(e)?o=i(e,t,n)>-1:typeof s=="number"?o=(Gn(e)?e.indexOf(t,n):i(e,t,n))>-1:xn(e,function(e){if(++r>=n)return!(o=e===t)}),o}function ar(e,t,n){var r=!0;t=Ut.createCallback(t,n,3);if(pn(e)){var i=-1,s=e.length;while(++i<s)if(!(r=!!t(e[i],i,e)))break}else xn(e,function(e,n,i){return r=!!t(e,n,i)});return r}function fr(e,t,n){var r=[];t=Ut.createCallback(t,n,3);if(pn(e)){var i=-1,s=e.length;while(++i<s){var o=e[i];t(o,i,e)&&r.push(o)}}else xn(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function lr(e,t,n){t=Ut.createCallback(t,n,3);if(!pn(e)){var o;return xn(e,function(e,n,r){if(t(e,n,r))return o=e,!1}),o}var r=-1,i=e.length;while(++r<i){var s=e[r];if(t(s,r,e))return s}}function cr(e,t,n){var r;return t=Ut.createCallback(t,n,3),pr(e,function(e,n,i){if(t(e,n,i))return r=e,!1}),r}function hr(e,t,n){if(t&&typeof n=="undefined"&&pn(e)){var r=-1,i=e.length;while(++r<i)if(t(e[r],r,e)===!1)break}else xn(e,t,n);return e}function pr(e,t,n){var r=e,i=e?e.length:0;t=t&&typeof n=="undefined"?t:Kt(t,n,3);if(pn(e)){while(i--)if(t(e[i],i,e)===!1)break}else{if(typeof i!="number"){var s=vn(e);i=s.length}else Wt.unindexedChars&&Gn(e)&&(r=e.split(""));xn(e,function(e,n,o){return n=s?s[--i]:--i,t(r[n],n,o)})}return e}function mr(e,t){var r=st(arguments,2),i=-1,s=typeof t=="function",o=e?e.length:0,u=n(typeof o=="number"?o:0);return hr(e,function(e){u[++i]=(s?t:e[t]).apply(e,r)}),u}function gr(e,t,r){var i=-1,s=e?e.length:0,o=n(typeof s=="number"?s:0);t=Ut.createCallback(t,r,3);if(pn(e))while(++i<s)o[i]=t(e[i],i,e);else xn(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function yr(e,t,n){var r=-Infinity,i=r;typeof t!="function"&&n&&n[t]===e&&(t=null);if(t==null&&pn(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u>i&&(i=u)}}else t=t==null&&Gn(e)?Q:Ut.createCallback(t,n,3),xn(e,function(e,n,s){var o=t(e,n,s);o>r&&(r=o,i=e)});return i}function br(e,t,n){var r=Infinity,i=r;typeof t!="function"&&n&&n[t]===e&&(t=null);if(t==null&&pn(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u<i&&(i=u)}}else t=t==null&&Gn(e)?Q:Ut.createCallback(t,n,3),xn(e,function(e,n,s){var o=t(e,n,s);o<r&&(r=o,i=e)});return i}function Er(e,t,n,r){var i=arguments.length<3;t=Ut.createCallback(t,r,4);if(pn(e)){var s=-1,o=e.length;i&&(n=e[++s]);while(++s<o)n=t(n,e[s],s,e)}else xn(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function Sr(e,t,n,r){var i=arguments.length<3;return t=Ut.createCallback(t,r,4),pr(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)}),n}function xr(e,t,n){return t=Ut.createCallback(t,n,3),fr(e,function(e,n,r){return!t(e,n,r)})}function Tr(e,n,r){e&&typeof e.length!="number"?e=ir(e):Wt.unindexedChars&&Gn(e)&&(e=e.split(""));if(n==null||r)return e?e[tn(0,e.length-1)]:t;var i=Nr(e);return i.length=jt(Bt(0,n),i.length),i}function Nr(e){var t=-1,r=e?e.length:0,i=n(typeof r=="number"?r:0);return hr(e,function(e){var n=tn(0,++t);i[t]=i[n],i[n]=e}),i}function Cr(e){var t=e?e.length:0;return typeof t=="number"?t:vn(e).length}function kr(e,t,n){var r;t=Ut.createCallback(t,n,3);if(pn(e)){var i=-1,s=e.length;while(++i<s)if(r=t(e[i],i,e))break}else xn(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function Lr(e,t,r){var i=-1,s=e?e.length:0,o=n(typeof s=="number"?s:0);t=Ut.createCallback(t,r,3),hr(e,function(e,n,r){var s=o[++i]=tt();s.criteria=t(e,n,r),s.index=i,s.value=e}),s=o.length,o.sort(G);while(s--){var u=o[s];o[s]=u.value,it(u)}return o}function Ar(e){return e&&typeof e.length=="number"?Wt.unindexedChars&&Gn(e)?e.split(""):st(e):ir(e)}function Mr(e){var t=-1,n=e?e.length:0,r=[];while(++t<n){var i=e[t];i&&r.push(i)}return r}function _r(e){return Gt(e,Yt(arguments,!0,!0,1))}function Dr(e,t,n){var r=-1,i=e?e.length:0;t=Ut.createCallback(t,n,3);while(++r<i)if(t(e[r],r,e))return r;return-1}function Pr(e,t,n){var r=e?e.length:0;t=Ut.createCallback(t,n,3);while(r--)if(t(e[r],r,e))return r;return-1}function Hr(e,n,r){var i=0,s=e?e.length:0;if(typeof n!="number"&&n!=null){var o=-1;n=Ut.createCallback(n,r,3);while(++o<s&&n(e[o],o,e))i++}else{i=n;if(i==null||r)return e?e[0]:t}return st(e,0,jt(Bt(0,i),s))}function Br(e,t,n,r){return typeof t!="boolean"&&t!=null&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=!1),n!=null&&(e=gr(e,n,r)),Yt(e,t)}function jr(e,t,n){if(typeof n=="number"){var r=e?e.length:0;n=n<0?Bt(0,r+n):n||0}else if(n){var i=Vr(e,t);return e[i]===t?i:-1}return $(e,t,n)}function Fr(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&t!=null){var s=i;t=Ut.createCallback(t,n,3);while(s--&&t(e[s],s,e))r++}else r=t==null||n?1:t||r;return st(e,0,jt(Bt(0,i-r),i))}function Ir(e){var t=arguments,n=t.length,r=-1,i=et(),s=-1,o=an(),u=e?e.length:0,f=[],l=et();while(++r<n){var c=t[r];i[r]=o===$&&(c?c.length:0)>=a&&Y(r?t[r]:l)}e:while(++s<u){var h=i[0];c=e[s];if((h?J(h,c):o(l,c))<0){r=n,(h||l).push(c);while(--r){h=i[r];if((h?J(h,c):o(t[r],c))<0)continue e}f.push(c)}}while(n--)h=i[n],h&&it(h);return rt(i),rt(l),f}function qr(e,n,r){var i=0,s=e?e.length:0;if(typeof n!="number"&&n!=null){var o=s;n=Ut.createCallback(n,r,3);while(o--&&n(e[o],o,e))i++}else{i=n;if(i==null||r)return e?e[s-1]:t}return st(e,Bt(0,s-i))}function Rr(e,t,n){var r=e?e.length:0;typeof n=="number"&&(r=(n<0?Bt(0,r+n):jt(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function Ur(e){var t=arguments,n=0,r=t.length,i=e?e.length:0;while(++n<r){var s=-1,o=t[n];while(++s<i)e[s]===o&&(Lt.call(e,s--,1),i--)}return e}function zr(e,t,r){e=+e||0,r=typeof r=="number"?r:+r||1,t==null&&(t=e,e=0);var i=-1,s=Bt(0,yt((t-e)/(r||1))),o=n(s);while(++i<s)o[i]=e,e+=r;return o}function Wr(e,t,n){var r=-1,i=e?e.length:0,s=[];t=Ut.createCallback(t,n,3);while(++r<i){var o=e[r];t(o,r,e)&&(s.push(o),Lt.call(e,r--,1),i--)}return s}function Xr(e,t,n){if(typeof t!="number"&&t!=null){var r=0,i=-1,s=e?e.length:0;t=Ut.createCallback(t,n,3);while(++i<s&&t(e[i],i,e))r++}else r=t==null||n?1:Bt(0,t);return st(e,r)}function Vr(e,t,n,r){var i=0,s=e?e.length:i;n=n?Ut.createCallback(n,r,1):vi,t=n(t);while(i<s){var o=i+s>>>1;n(e[o])<t?i=o+1:s=o}return i}function $r(e){return nn(Yt(arguments,!0,!0))}function Jr(e,t,n,r){return typeof t!="boolean"&&t!=null&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=!1),n!=null&&(n=Ut.createCallback(n,r,3)),nn(e,t,n)}function Kr(e){return Gt(e,st(arguments,1))}function Qr(){var e=arguments.length>1?arguments:arguments[0],t=-1,r=e?yr(wr(e,"length")):0,i=n(r<0?0:r);while(++t<r)i[t]=wr(e,t);return i}function Gr(e,t){var n=-1,r=e?e.length:0,i={};while(++n<r){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function Yr(e,t){if(!Wn(t))throw new lt;return function(){if(--e<1)return t.apply(this,arguments)}}function Zr(e,t){return arguments.length>2?sn(e,17,st(arguments,2),null,t):sn(e,1,null,null,t)}function ei(e){var t=arguments.length>1?Yt(arguments,!0,!1,1):Hn(e),n=-1,r=t.length;while(++n<r){var i=t[n];e[i]=sn(e[i],1,null,null,e)}return e}function ti(e,t){return arguments.length>2?sn(t,19,st(arguments,2),null,e):sn(t,3,null,null,e)}function ni(){var e=arguments,t=e.length;while(t--)if(!Wn(e[t]))throw new lt;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function ri(e,t,n){var r=typeof e;if(e==null||r=="function")return Kt(e,t,n);if(r!="object")return function(t){return t[e]};var i=vn(e),s=i[0],o=e[s];return i.length==1&&o===o&&!Xn(o)?function(e){var t=e[s];return o===t&&(o!==0||1/o==1/t)}:function(t){var n=i.length,r=!1;while(n--)if(!(r=Zt(t[i[n]],e[i[n]],null,!0)))break;return r}}function ii(e,t){return t=typeof t=="number"?t:+t||e.length,sn(e,4,null,null,null,t)}function si(e,n,r){var i,s,o,u,a,f,l,c=0,h=!1,p=!0;if(!Wn(e))throw new lt;n=Bt(0,n)||0;if(r===!0){var d=!0;p=!1}else Xn(r)&&(d=r.leading,h="maxWait"in r&&(Bt(n,r.maxWait)||0),p="trailing"in r?r.trailing:p);var v=function(){var r=n-(Tt()-u);if(r<=0){s&&bt(s);var h=l;s=f=l=t,h&&(c=Tt(),o=e.apply(a,i),!f&&!s&&(i=a=null))}else f=kt(v,r)},m=function(){f&&bt(f),s=f=l=t;if(p||h!==n)c=Tt(),o=e.apply(a,i),!f&&!s&&(i=a=null)};return function(){i=arguments,u=Tt(),a=this,l=p&&(f||!d);if(h===!1)var t=d&&!f;else{!s&&!d&&(c=u);var r=h-(u-c),g=r<=0;g?(s&&(s=bt(s)),c=u,o=e.apply(a,i)):s||(s=kt(m,r))}return g&&f?f=bt(f):!f&&n!==h&&(f=kt(v,n)),t&&(g=!0,o=e.apply(a,i)),g&&!f&&!s&&(i=a=null),o}}function oi(e){if(!Wn(e))throw new lt;var n=st(arguments,1);return kt(function(){e.apply(t,n)},1)}function ui(e,n){if(!Wn(e))throw new lt;var r=st(arguments,2);return kt(function(){e.apply(t,r)},n)}function ai(e,t){if(!Wn(e))throw new lt;var n=function(){var r=n.cache,i=t?t.apply(this,arguments):u+arguments[0];return xt.call(r,i)?r[i]:r[i]=e.apply(this,arguments)};return n.cache={},n}function fi(e){var t,n;if(!Wn(e))throw new lt;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function li(e){return sn(e,16,st(arguments,1))}function ci(e){return sn(e,32,null,st(arguments,1))}function hi(e,t,n){var r=!0,i=!0;if(!Wn(e))throw new lt;return n===!1?r=!1:Xn(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),j.leading=r,j.maxWait=t,j.trailing=i,si(e,t,j)}function pi(e,t){return sn(t,16,[e])}function di(e){return e==null?"":ft(e).replace(Sn,un)}function vi(e){return e}function mi(e,t){var n=e,r=!t||Wn(n);t||(n=zt,t=e,e=Ut),hr(Hn(t),function(i){var s=e[i]=t[i];r&&(n.prototype[i]=function(){var t=this.__wrapped__,r=[t];Nt.apply(r,arguments);var i=s.apply(e,r);return t&&typeof t=="object"&&t===i?this:(i=new n(i),i.__chain__=this.__chain__,i)})})}function gi(){return e._=vt,this}function yi(){}function wi(e,t,n){var r=e==null,i=t==null;n==null&&(typeof e=="boolean"&&i?(n=e,e=1):!i&&typeof t=="boolean"&&(n=t,i=!0)),r&&i&&(t=1),e=+e||0,i?(t=e,e=0):t=+t||0;if(n||e%1||t%1){var s=It();return jt(e+s*(t-e+parseFloat("1e-"+((s+"").length-1))),t)}return tn(e,t)}function Ei(e,t){if(e){var n=e[t];return Wn(n)?e[t]():n}}function Si(e,n,r){var i=Ut.templateSettings;e=ft(e||""),r=Ln({},r,i);var s=Ln({},r.imports,i.imports),o=vn(s),u=ir(s),a,f=0,l=r.interpolate||b,v="__p += '",m=at((r.escape||b).source+"|"+l.source+"|"+(l===g?d:b).source+"|"+(r.evaluate||b).source+"|$","g");e.replace(m,function(t,n,r,i,s,o){return r||(r=i),v+=e.slice(f,o).replace(E,Z),n&&(v+="' +\n__e("+n+") +\n'"),s&&(a=!0,v+="';\n"+s+";\n__p += '"),r&&(v+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),f=o+t.length,t}),v+="';\n";var y=r.variable,w=y;w||(y="obj",v="with ("+y+") {\n"+v+"\n}\n"),v=(a?v.replace(c,""):v).replace(h,"$1").replace(p,"$1;"),v="function("+y+") {\n"+(w?"":y+" || ("+y+" = {});\n")+"var __t, __p = '', __e = _.escape"+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+v+"return __p\n}";var S="\n/*\n//# sourceURL="+(r.sourceURL||"/lodash/template/source["+T++ +"]")+"\n*/";try{var x=R(o,"return "+v+S).apply(t,u)}catch(N){throw N.source=v,N}return n?x(n):(x.source=v,x)}function xi(e,t,r){e=(e=+e)>-1?e:0;var i=-1,s=n(e);t=Kt(t,r,1);while(++i<e)s[i]=t(i);return s}function Ti(e){return e==null?"":ft(e).replace(En,cn)}function Ni(e){var t=++s;return ft(e==null?"":e)+t}function Ci(e){return e=new zt(e),e.__chain__=!0,e}function ki(e,t){return t(e),e}function Li(){return this.__chain__=!0,this}function Ai(){return ft(this.__wrapped__)}function Oi(){return this.__wrapped__}e=e?ut.defaults(U.Object(),e,ut.pick(U,S)):U;var n=e.Array,r=e.Boolean,i=e.Date,f=e.Error,R=e.Function,z=e.Math,W=e.Number,K=e.Object,at=e.RegExp,ft=e.String,lt=e.TypeError,ct=[],ht=f.prototype,pt=K.prototype,dt=ft.prototype,vt=e._,mt=pt.toString,gt=at("^"+ft(mt).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),yt=z.ceil,bt=e.clearTimeout,wt=z.floor,Et=R.prototype.toString,St=gt.test(St=K.getPrototypeOf)&&St,xt=pt.hasOwnProperty,Tt=gt.test(Tt=i.now)&&Tt||function(){return+(new i)},Nt=ct.push,Ct=pt.propertyIsEnumerable,kt=e.setTimeout,Lt=ct.splice,At=typeof (At=V&&X&&V.setImmediate)=="function"&&!gt.test(At)&&At,Ot=function(){try{var e={},t=gt.test(t=K.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}(),Mt=gt.test(Mt=K.create)&&Mt,_t=gt.test(_t=n.isArray)&&_t,Dt=e.isFinite,Pt=e.isNaN,Ht=gt.test(Ht=K.keys)&&Ht,Bt=z.max,jt=z.min,Ft=e.parseInt,It=z.random,qt={};qt[C]=n,qt[L]=r,qt[A]=i,qt[M]=R,qt[D]=K,qt[_]=W,qt[P]=at,qt[H]=ft;var Rt={};Rt[C]=Rt[A]=Rt[_]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Rt[L]=Rt[H]={constructor:!0,toString:!0,valueOf:!0},Rt[O]=Rt[M]=Rt[P]={constructor:!0,toString:!0},Rt[D]={constructor:!0},function(){var e=x.length;while(e--){var t=x[e];for(var n in Rt)xt.call(Rt,n)&&!xt.call(Rt[n],t)&&(Rt[n][t]=!1)}}(),zt.prototype=Ut.prototype;var Wt=Ut.support={};(function(){var t=function(){this.x=1},r={0:1,length:1},i=[];t.prototype={valueOf:1,y:1};for(var s in new t)i.push(s);for(s in arguments);Wt.argsClass=mt.call(arguments)==N,Wt.argsObject=arguments.constructor==K&&!(arguments instanceof n),Wt.enumErrorProps=Ct.call(ht,"message")||Ct.call(ht,"name"),Wt.enumPrototypes=Ct.call(t,"prototype"),Wt.funcDecomp=!gt.test(e.WinRTError)&&w.test(ot),Wt.funcNames=typeof R.name=="string",Wt.nonEnumArgs=s!=0,Wt.nonEnumShadows=!/valueOf/.test(i),Wt.ownLast=i[0]!="x",Wt.spliceObjects=(ct.splice.call(r,0,1),!r[0]),Wt.unindexedChars="x"[0]+K("x")[0]!="xx";try{Wt.nodeClass=mt.call(document)!=D||!!({toString:0}+"")}catch(o){Wt.nodeClass=!0}})(1),Ut.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:g,variable:"",imports:{_:Ut}};var Xt=function(e){var t="var index, iterable = "+e.firstArg+", result = "+e.init+";\nif (!iterable) return result;\n"+e.top+";";e.array?(t+="\nvar length = iterable.length; index = -1;\nif ("+e.array+") {  ",Wt.unindexedChars&&(t+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),t+="\n  while (++index < length) {\n    "+e.loop+";\n  }\n}\nelse {  "):Wt.nonEnumArgs&&(t+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+e.loop+";\n    }\n  } else {  "),Wt.enumPrototypes&&(t+="\n  var skipProto = typeof iterable == 'function';\n  "),Wt.enumErrorProps&&(t+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var n=[];Wt.enumPrototypes&&n.push('!(skipProto && index == "prototype")'),Wt.enumErrorProps&&n.push('!(skipErrorProps && (index == "message" || index == "name"))');if(e.useHas&&e.keys)t+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }  ";else{t+="\n  for (index in iterable) {\n",e.useHas&&n.push("hasOwnProperty.call(iterable, index)"),n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }    ";if(Wt.nonEnumShadows){t+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ";for(k=0;k<7;k++)t+="\n    index = '"+e.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",e.useHas||(t+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),t+=") {\n      "+e.loop+";\n    }      ";t+="\n  }    "}}if(e.array||Wt.nonEnumArgs)t+="\n}";return t+=e.bottom+";\nreturn result",t};Mt||(Jt=function(){function t(){}return function(n){if(Xn(n)){t.prototype=n;var r=new t;t.prototype=null}return r||e.Object()}}());var fn=Ot?function(e,t){F.value=t,Ot(e,"__bindData__",F)}:yi;Wt.argsClass||(hn=function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&xt.call(e,"callee")&&!Ct.call(e,"callee")||!1});var pn=_t||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&mt.call(e)==C||!1},dn=on({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),vn=Ht?function(e){return Xn(e)?Wt.enumPrototypes&&typeof e=="function"||Wt.nonEnumArgs&&e.length&&hn(e)?dn(e):Ht(e):[]}:dn,mn={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:vn,loop:"if (callback(iterable[index], index, collection) === false) return result"},gn={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:vn,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},yn={top:"if (!objectTypes[typeof iterable]) return result;\n"+mn.top,array:!1},bn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wn=jn(bn),En=at("("+vn(wn).join("|")+")","g"),Sn=at("["+vn(bn).join("")+"]","g"),xn=on(mn),Tn=on(gn,{top:gn.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Ln=on(gn),Mn=on(mn,yn,{useHas:!1}),Dn=on(mn,yn);Wn(/x/)&&(Wn=function(e){return typeof e=="function"&&mt.call(e)==M});var Kn=St?function(e){if(!e||mt.call(e)!=D||!Wt.argsClass&&hn(e))return!1;var t=e.valueOf,n=typeof t=="function"&&(n=St(t))&&St(n);return n?e==n||St(e)==n:ln(e)}:ln,ur=rn(function(e,t,n){xt.call(e,n)?e[n]++:e[n]=1}),dr=rn(function(e,t,n){(xt.call(e,n)?e[n]:e[n]=[]).push(t)}),vr=rn(function(e,t,n){e[n]=t}),wr=gr,Or=fr;At&&(oi=function(t){if(!Wn(t))throw new lt;return At.apply(e,arguments)});var bi=Ft(l+"08")==8?Ft:function(e,t){return Ft(Gn(e)?e.replace(y,""):e,t||0)};return Ut.after=Yr,Ut.assign=Tn,Ut.at=sr,Ut.bind=Zr,Ut.bindAll=ei,Ut.bindKey=ti,Ut.chain=Ci,Ut.compact=Mr,Ut.compose=ni,Ut.countBy=ur,Ut.create=kn,Ut.createCallback=ri,Ut.curry=ii,Ut.debounce=si,Ut.defaults=Ln,Ut.defer=oi,Ut.delay=ui,Ut.difference=_r,Ut.filter=fr,Ut.flatten=Br,Ut.forEach=hr,Ut.forEachRight=pr,Ut.forIn=Mn,Ut.forInRight=_n,Ut.forOwn=Dn,Ut.forOwnRight=Pn,Ut.functions=Hn,Ut.groupBy=dr,Ut.indexBy=vr,Ut.initial=Fr,Ut.intersection=Ir,Ut.invert=jn,Ut.invoke=mr,Ut.keys=vn,Ut.map=gr,Ut.max=yr,Ut.memoize=ai,Ut.merge=Zn,Ut.min=br,Ut.omit=er,Ut.once=fi,Ut.pairs=tr,Ut.partial=li,Ut.partialRight=ci,Ut.pick=nr,Ut.pluck=wr,Ut.pull=Ur,Ut.range=zr,Ut.reject=xr,Ut.remove=Wr,Ut.rest=Xr,Ut.shuffle=Nr,Ut.sortBy=Lr,Ut.tap=ki,Ut.throttle=hi,Ut.times=xi,Ut.toArray=Ar,Ut.transform=rr,Ut.union=$r,Ut.uniq=Jr,Ut.values=ir,Ut.where=Or,Ut.without=Kr,Ut.wrap=pi,Ut.zip=Qr,Ut.zipObject=Gr,Ut.collect=gr,Ut.drop=Xr,Ut.each=hr,Ut.eachRight=pr,Ut.extend=Tn,Ut.methods=Hn,Ut.object=Gr,Ut.select=fr,Ut.tail=Xr,Ut.unique=Jr,Ut.unzip=Qr,mi(Ut),Ut.clone=Nn,Ut.cloneDeep=Cn,Ut.contains=or,Ut.escape=di,Ut.every=ar,Ut.find=lr,Ut.findIndex=Dr,Ut.findKey=An,Ut.findLast=cr,Ut.findLastIndex=Pr,Ut.findLastKey=On,Ut.has=Bn,Ut.identity=vi,Ut.indexOf=jr,Ut.isArguments=hn,Ut.isArray=pn,Ut.isBoolean=Fn,Ut.isDate=In,Ut.isElement=qn,Ut.isEmpty=Rn,Ut.isEqual=Un,Ut.isFinite=zn,Ut.isFunction=Wn,Ut.isNaN=Vn,Ut.isNull=$n,Ut.isNumber=Jn,Ut.isObject=Xn,Ut.isPlainObject=Kn,Ut.isRegExp=Qn,Ut.isString=Gn,Ut.isUndefined=Yn,Ut.lastIndexOf=Rr,Ut.mixin=mi,Ut.noConflict=gi,Ut.noop=yi,Ut.parseInt=bi,Ut.random=wi,Ut.reduce=Er,Ut.reduceRight=Sr,Ut.result=Ei,Ut.runInContext=ot,Ut.size=Cr,Ut.some=kr,Ut.sortedIndex=Vr,Ut.template=Si,Ut.unescape=Ti,Ut.uniqueId=Ni,Ut.all=ar,Ut.any=kr,Ut.detect=lr,Ut.findWhere=lr,Ut.foldl=Er,Ut.foldr=Sr,Ut.include=or,Ut.inject=Er,Dn(Ut,function(e,t){Ut.prototype[t]||(Ut.prototype[t]=function(){var t=[this.__wrapped__],n=this.__chain__;Nt.apply(t,arguments);var r=e.apply(Ut,t);return n?new zt(r,n):r})}),Ut.first=Hr,Ut.last=qr,Ut.sample=Tr,Ut.take=Hr,Ut.head=Hr,Dn(Ut,function(e,t){var n=t!=="sample";Ut.prototype[t]||(Ut.prototype[t]=function(t,r){var i=this.__chain__,s=e(this.__wrapped__,t,r);return!i&&(t==null||r&&(!n||typeof t!="function"))?s:new zt(s,i)})}),Ut.VERSION="2.3.0",Ut.prototype.chain=Li,Ut.prototype.toString=Ai,Ut.prototype.value=Oi,Ut.prototype.valueOf=Oi,xn(["join","pop","shift"],function(e){var t=ct[e];Ut.prototype[e]=function(){var e=this.__chain__
,n=t.apply(this.__wrapped__,arguments);return e?new zt(n,e):n}}),xn(["push","reverse","sort","unshift"],function(e){var t=ct[e];Ut.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),xn(["concat","slice","splice"],function(e){var t=ct[e];Ut.prototype[e]=function(){return new zt(t.apply(this.__wrapped__,arguments),this.__chain__)}}),Wt.spliceObjects||xn(["pop","shift","splice"],function(e){var t=ct[e],n=e=="splice";Ut.prototype[e]=function(){var e=this.__chain__,r=this.__wrapped__,i=t.apply(r,arguments);return r.length===0&&delete r[0],e||n?new zt(i,e):i}}),Ut}var t,r=[],i=[],s=0,o={},u=+(new Date)+"",a=75,f=40,l=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",c=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,p=/(__e\(.*?\)|\b__t\)) \+\n'';/g,d=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,v=/\w*$/,m=/^\s*function[ \n\r\t]+\w/,g=/<%=([\s\S]+?)%>/g,y=RegExp("^["+l+"]*0+(?=.$)"),b=/($^)/,w=/\bthis\b/,E=/['\n\r\t\u2028\u2029\\]/g,S=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],x=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],T=0,N="[object Arguments]",C="[object Array]",L="[object Boolean]",A="[object Date]",O="[object Error]",M="[object Function]",_="[object Number]",D="[object Object]",P="[object RegExp]",H="[object String]",B={};B[M]=!1,B[N]=B[C]=B[L]=B[A]=B[_]=B[D]=B[P]=B[H]=!0;var j={leading:!1,maxWait:0,trailing:!1},F={configurable:!1,enumerable:!1,value:null,writable:!1},I={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},q={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},R={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},U=q[typeof window]&&window||this,z=q[typeof e]&&e&&!e.nodeType&&e,W=q[typeof n]&&n&&!n.nodeType&&n,X=W&&W.exports===z&&z,V=q[typeof global]&&global;V&&(V.global===V||V.window===V)&&(U=V);var ut=ot();typeof define=="function"&&typeof define.amd=="object"&&define.amd?define(function(){return ut}):z&&W?X?(W.exports=ut)._=ut:z._=ut:U._=ut}).call(this)}),e.register("component-event/index.js",function(e,t,n){var r=window.addEventListener!==undefined?"addEventListener":"attachEvent",i=window.removeEventListener!==undefined?"removeEventListener":"detachEvent",s=r!=="addEventListener"?"on":"";e.bind=function(e,t,n,i){return e[r](s+t,n,i||!1),n},e.unbind=function(e,t,n,r){return e[i](s+t,n,r||!1),n}}),e.register("component-query/index.js",function(e,t,n){function r(e,t){return t.querySelector(e)}e=n.exports=function(e,t){return t=t||document,r(e,t)},e.all=function(e,t){return t=t||document,t.querySelectorAll(e)},e.engine=function(t){if(!t.one)throw new Error(".one callback required");if(!t.all)throw new Error(".all callback required");return r=t.one,e.all=t.all,e}}),e.register("component-matches-selector/index.js",function(e,t,n){function o(e,t){if(s)return s.call(e,t);var n=r.all(t,e.parentNode);for(var i=0;i<n.length;++i)if(n[i]==e)return!0;return!1}var r=t("query"),i=Element.prototype,s=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector;n.exports=o}),e.register("discore-closest/index.js",function(e,t,n){var r=t("matches-selector");n.exports=function(e,t,n,i){e=n?e:e.parentNode,i=i||document;do{if(r(e,t))return e;if(e===i)return}while((e=e.parentNode)&&e!==document)}}),e.register("component-delegate/index.js",function(e,t,n){var r=t("closest"),i=t("event");e.bind=function(e,t,n,s,o){return i.bind(e,n,function(n){var i=n.target||n.srcElement;n.delegateTarget=r(i,t,!0,e),n.delegateTarget&&s.call(e,n)},o)},e.unbind=function(e,t,n,r){i.unbind(e,t,n,r)}}),e.register("stagas-binder/index.js",function(e,t,n){var r=t("event"),i=t("delegate");e.on=function(e,t,n,s,o){return"string"==typeof n?(s._delegate=i.bind(e,n,t,s,o),this):(o=s,s=n,r.bind(e,t,s,o),e)},e.off=function(e,t,n,s,o){switch(typeof n){case"function":o=s,s=n;if(!s._delegate)break;case"string":return i.unbind(e,t,s._delegate,o),this}return r.unbind(e,t,s,o),e},e.once=function(t,n,r,i,s){return"function"==typeof r?(s=i,i=r,e.on(t,n,function o(r){e.off(t,n,o,s),i.call(t,r)},s)):e.on(t,n,r,function u(o){e.off(t,n,r,u,s),i.call(t,o)},s),t}}),e.register("component-indexof/index.js",function(e,t,n){n.exports=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}}),e.register("component-classes/index.js",function(e,t,n){function o(e){if(!e)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}var r=t("indexof"),i=/\s+/,s=Object.prototype.toString;n.exports=function(e){return new o(e)},o.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=r(t,e);return~n||t.push(e),this.el.className=t.join(" "),this},o.prototype.remove=function(e){if("[object RegExp]"==s.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=r(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},o.prototype.removeMatching=function(e){var t=this.array();for(var n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},o.prototype.toggle=function(e){return this.list?(this.list.toggle(e),this):(this.has(e)?this.remove(e):this.add(e),this)},o.prototype.array=function(){var e=this.el.className.replace(/^\s+|\s+$/g,""),t=e.split(i);return""===t[0]&&t.shift(),t},o.prototype.has=o.prototype.contains=function(e){return this.list?this.list.contains(e):!!~r(this.array(),e)}}),e.register("component-trim/index.js",function(e,t,n){function r(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}e=n.exports=r,e.left=function(e){return e.trimLeft?e.trimLeft():e.replace(/^\s*/,"")},e.right=function(e){return e.trimRight?e.trimRight():e.replace(/\s*$/,"")}}),e.register("caolan-async/lib/async.js",function(e,t,n){(function(){function i(e){var n=!1;return function(){if(n)throw new Error("Callback was already called.");n=!0,e.apply(t,arguments)}}var e={},t,r;t=this,t!=null&&(r=t.async),e.noConflict=function(){return t.async=r,e};var s=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n+=1)t(e[n],n,e)},o=function(e,t){if(e.map)return e.map(t);var n=[];return s(e,function(e,r,i){n.push(t(e,r,i))}),n},u=function(e,t,n){return e.reduce?e.reduce(t,n):(s(e,function(e,r,i){n=t(n,e,r,i)}),n)},a=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};typeof process=="undefined"||!process.nextTick?typeof setImmediate=="function"?(e.nextTick=function(e){setImmediate(e)},e.setImmediate=e.nextTick):(e.nextTick=function(e){setTimeout(e,0)},e.setImmediate=e.nextTick):(e.nextTick=process.nextTick,typeof setImmediate!="undefined"?e.setImmediate=setImmediate:e.setImmediate=e.nextTick),e.each=function(e,t,n){n=n||function(){};if(!e.length)return n();var r=0;s(e,function(s){t(s,i(function(t){t?(n(t),n=function(){}):(r+=1,r>=e.length&&n(null))}))})},e.forEach=e.each,e.eachSeries=function(e,t,n){n=n||function(){};if(!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1,r>=e.length?n(null):i())})};i()},e.forEachSeries=e.eachSeries,e.eachLimit=function(e,t,n,r){var i=f(t);i.apply(null,[e,n,r])},e.forEachLimit=e.eachLimit;var f=function(e){return function(t,n,r){r=r||function(){};if(!t.length||e<=0)return r();var i=0,s=0,o=0;(function u(){if(i>=t.length)return r();while(o<e&&s<t.length)s+=1,o+=1,n(t[s-1],function(e){e?(r(e),r=function(){}):(i+=1,o-=1,i>=t.length?r():u())})})()}},l=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[e.each].concat(n))}},c=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[f(e)].concat(n))}},h=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[e.eachSeries].concat(n))}},p=function(e,t,n,r){var i=[];t=o(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r,t(n)})},function(e){r(e,i)})};e.map=l(p),e.mapSeries=h(p),e.mapLimit=function(e,t,n,r){return d(t)(e,n,r)};var d=function(e){return c(e,p)};e.reduce=function(t,n,r,i){e.eachSeries(t,function(e,t){r(n,e,function(e,r){n=r,t(e)})},function(e){i(e,n)})},e.inject=e.reduce,e.foldl=e.reduce,e.reduceRight=function(t,n,r,i){var s=o(t,function(e){return e}).reverse();e.reduce(s,n,r,i)},e.foldr=e.reduceRight;var v=function(e,t,n,r){var i=[];t=o(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&i.push(e),t()})},function(e){r(o(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};e.filter=l(v),e.filterSeries=h(v),e.select=e.filter,e.selectSeries=e.filterSeries;var m=function(e,t,n,r){var i=[];t=o(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||i.push(e),t()})},function(e){r(o(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};e.reject=l(m),e.rejectSeries=h(m);var g=function(e,t,n,r){e(t,function(e,t){n(e,function(n){n?(r(e),r=function(){}):t()})},function(e){r()})};e.detect=l(g),e.detectSeries=h(g),e.some=function(t,n,r){e.each(t,function(e,t){n(e,function(e){e&&(r(!0),r=function(){}),t()})},function(e){r(!1)})},e.any=e.some,e.every=function(t,n,r){e.each(t,function(e,t){n(e,function(e){e||(r(!1),r=function(){}),t()})},function(e){r(!0)})},e.all=e.every,e.sortBy=function(t,n,r){e.map(t,function(e,t){n(e,function(n,r){n?t(n):t(null,{value:e,criteria:r})})},function(e,t){if(e)return r(e);var n=function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0};r(null,o(t.sort(n),function(e){return e.value}))})},e.auto=function(t,n){n=n||function(){};var r=a(t);if(!r.length)return n(null);var i={},o=[],f=function(e){o.unshift(e)},l=function(e){for(var t=0;t<o.length;t+=1)if(o[t]===e){o.splice(t,1);return}},c=function(){s(o.slice(0),function(e){e()})};f(function(){a(i).length===r.length&&(n(null,i),n=function(){})}),s(r,function(r){var o=t[r]instanceof Function?[t[r]]:t[r],h=function(t){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]);if(t){var u={};s(a(i),function(e){u[e]=i[e]}),u[r]=o,n(t,u),n=function(){}}else i[r]=o,e.setImmediate(c)},p=o.slice(0,Math.abs(o.length-1))||[],d=function(){return u(p,function(e,t){return e&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(r)};if(d())o[o.length-1](h,i);else{var v=function(){d()&&(l(v),o[o.length-1](h,i))};f(v)}})},e.waterfall=function(t,n){n=n||function(){};if(t.constructor!==Array){var r=new Error("First argument to waterfall must be an array of functions");return n(r)}if(!t.length)return n();var i=function(t){return function(r){if(r)n.apply(null,arguments),n=function(){};else{var s=Array.prototype.slice.call(arguments,1),o=t.next();o?s.push(i(o)):s.push(n),e.setImmediate(function(){t.apply(null,s)})}}};i(e.iterator(t))()};var y=function(e,t,n){n=n||function(){};if(t.constructor===Array)e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.each(a(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}};e.parallel=function(t,n){y({map:e.map,each:e.each},t,n)},e.parallelLimit=function(e,t,n){y({map:d(t),each:f(t)},e,n)},e.series=function(t,n){n=n||function(){};if(t.constructor===Array)e.mapSeries(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.eachSeries(a(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}},e.iterator=function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)},e.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var b=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]),t(e)})},function(e){r(e,i)})};e.concat=l(b),e.concatSeries=h(b),e.whilst=function(t,n,r){t()?n(function(i){if(i)return r(i);e.whilst(t,n,r)}):r()},e.doWhilst=function(t,n,r){t(function(i){if(i)return r(i);n()?e.doWhilst(t,n,r):r()})},e.until=function(t,n,r){t()?r():n(function(i){if(i)return r(i);e.until(t,n,r)})},e.doUntil=function(t,n,r){t(function(i){if(i)return r(i);n()?r():e.doUntil(t,n,r)})},e.queue=function(t,n){function r(t,r,i,o){r.constructor!==Array&&(r=[r]),s(r,function(r){var s={data:r,callback:typeof o=="function"?o:null};i?t.tasks.unshift(s):t.tasks.push(s),t.saturated&&t.tasks.length===n&&t.saturated(),e.setImmediate(t.process)})}n===undefined&&(n=1);var o=0,u={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,push:function(e,t){r(u,e,!1,t)},unshift:function(e,t){r(u,e,!0,t)},process:function(){if(o<u.concurrency&&u.tasks.length){var e=u.tasks.shift();u.empty&&u.tasks.length===0&&u.empty(),o+=1;var n=function(){o-=1,e.callback&&e.callback.apply(e,arguments),u.drain&&u.tasks.length+o===0&&u.drain(),u.process()},r=i(n);t(e.data,r)}},length:function(){return u.tasks.length},running:function(){return o}};return u},e.cargo=function(t,n){var r=!1,i=[],u={tasks:i,payload:n,saturated:null,empty:null,drain:null,push:function(t,r){t.constructor!==Array&&(t=[t]),s(t,function(e){i.push({data:e,callback:typeof r=="function"?r:null}),u.saturated&&i.length===n&&u.saturated()}),e.setImmediate(u.process)},process:function a(){if(r)return;if(i.length===0){u.drain&&u.drain();return}var e=typeof n=="number"?i.splice(0,n):i.splice(0),f=o(e,function(e){return e.data});u.empty&&u.empty(),r=!0,t(f,function(){r=!1;var t=arguments;s(e,function(e){e.callback&&e.callback.apply(null,t)}),a()})},length:function(){return i.length},running:function(){return r}};return u};var w=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(t?console.error&&console.error(t):console[e]&&s(n,function(t){console[e](t)}))}]))}};e.log=w("log"),e.dir=w("dir"),e.memoize=function(e,t){var n={},r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments),s=i.pop(),o=t.apply(null,i);o in n?s.apply(null,n[o]):o in r?r[o].push(s):(r[o]=[s],e.apply(null,i.concat([function(){n[o]=arguments;var e=r[o];delete r[o];for(var t=0,i=e.length;t<i;t++)e[t].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=e,i},e.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},e.times=function(t,n,r){var i=[];for(var s=0;s<t;s++)i.push(s);return e.map(i,n,r)},e.timesSeries=function(t,n,r){var i=[];for(var s=0;s<t;s++)i.push(s);return e.mapSeries(i,n,r)},e.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();e.reduce(t,r,function(e,t,r){t.apply(n,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,t){i.apply(n,[e].concat(t))})}};var E=function(e,t){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return e(t,function(e,t){e.apply(n,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};e.applyEach=l(E),e.applyEachSeries=h(E),e.forever=function(e,t){function n(r){if(r){if(t)return t(r);throw r}e(n)}n()},typeof define!="undefined"&&define.amd?define([],function(){return e}):typeof n!="undefined"&&n.exports?n.exports=e:t.async=e})()}),e.register("component-emitter/index.js",function(e,t,n){function i(e){if(e)return s(e)}function s(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}var r=t("indexof");n.exports=i,i.prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},i.prototype.once=function(e,t){function r(){n.off(e,r),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},t._off=r,this.on(e,r),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;var i=r(n,t._off||t);return~i&&n.splice(i,1),this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}}),e.register("goinstant-usercache/usercache.js",function(e,t,n){"use strict";function u(e){this._room=e,this._users={},this._usersKeys={},this._localUserId=null,this._emitter=new s,r.bindAll(this,["_updateUser","_handleLeaveEvent","_handleJoinEvent","_getUsers","_bindPlatformEvents","_getLocalUserId"])}var r=t("lodash"),i=t("async"),s=t("emitter"),o=["join","leave","change"];u.prototype.initialize=function(e){if(!e||!r.isFunction(e))throw new Error("Callback was not found or invalid");var t=[this._getLocalUserId,this._bindPlatformEvents,this._getUsers],n=this;i.series(t,function(t){if(t)return n.destroy(function(){return e(t)});e()})},u.prototype.destroy=function(e){var t=this;if(!e||!r.isFunction(e))throw new Error("Callback was not found or invalid");var n=t._room.key("/.users"),s=[r.bind(t._room.off,t._room,"leave",t._handleLeaveEvent),r.bind(t._room.off,t._room,"join",t._handleJoinEvent),r.bind(n.off,n,"set",t._updateUser),r.bind(n.off,n,"remove",t._updateUser)];t._emitter.off(),i.parallel(s,e)},u.prototype.getUser=function(e){var t=this._users[e];if(!t)throw new Error("Invalid id: user not found.");return t},u.prototype.getAll=function(){return r.toArray(this._users)},u.prototype.getLocalUser=function(){return this.getUser(this._localUserId)},u.prototype.getUserKey=function(e){var t=this._usersKeys[e];if(!t)throw new Error("Invalid id: user key not found.");return t},u.prototype.getAllUserKeys=function(){return r.toArray(this._usersKeys)},u.prototype.getLocalUserKey=function(){return this.getUserKey(this._localUserId)},u.prototype.on=function(e,t){if(!r.contains(o,e))throw new Error('Invalid event: "'+e+'" is not a valid event.');if(!r.isFunction(t))throw new Error("Invalid argument: listener function is required");this._emitter.on(e,t)},u.prototype.off=function(e,t){var n=Array.prototype.slice.call(arguments);this._emitter.off.apply(this._emitter,n)},u.prototype._getLocalUserId=function(e){var t=this;this._room.user(function(n,r){if(n)return e(n);t._localUserId=r.id,e()})},u.prototype._getUsers=function(e){var t=this;this._room.users(function(n,r,i){if(n)return e(n);t._users=r,t._usersKeys=i,e()})},u.prototype._bindPlatformEvents=function(e){var t=this,n=t._room.key("/.users"),s={local:!0,bubble:!0,listener:t._updateUser},o=[r.bind(t._room.on,t._room,"leave",t._handleLeaveEvent),r.bind(t._room.on,t._room,"join",t._handleJoinEvent),r.bind(n.on,n,"set",s),r.bind(n.on,n,"remove",s)];i.parallel(o,e)},u.prototype._updateUser=function(e,t){var n=this;this._room.key("/.users/"+t.userId).get(function(e,r){if(e)throw e;n._users[r.id]=r,n._emitter.emit("change",r,t.key)})},u.prototype._handleJoinEvent=function(e){this._users[e.id]=e,this._usersKeys[e.id]=this._room.key("/.users/"+e.id),this._emitter.emit("join",e)},u.prototype._handleLeaveEvent=function(e){delete this._users[e.id],delete this._usersKeys[e.id],this._emitter.emit("leave",e)},n.exports=u}),e.register("goinstant-colors-common/colors.js",function(e,t,n){"use strict";var r={};n.exports=r,r.REGEX=/^#([0-9A-F]{6}|[0-9A-F]{3})$/i,r.DEFAULT="#aaa",r.DEFAULTS=["#3bb200","#fc2a29","#06b8de","#e6c615","#7151e8","#8fe62e","#f60889","#51e8c3","#e65515","#c186ef","#734701","#3a9fab","#b6004d","#d4b37e","#4f7603","#8759b6","#2a82cd","#de9c8d","#003f85","#bd852c"],r.USER_PROPERTY="avatarColor",r.USER_PROPERTY_REGEX=new RegExp("/"+r.USER_PROPERTY+"$"),r.validate=function(e){return typeof e=="string"&&r.REGEX.test(e)},r.get=function(e){var t=e[r.USER_PROPERTY];return r.validate(t)?t:r.DEFAULT},r.isUserProperty=function(e){return typeof e=="string"&&r.USER_PROPERTY_REGEX.test(e)}}),e.register("chat/index.js",function(e,t,n){"use strict";function H(e){if(!e||!o.isPlainObject(e))throw l.create("Chat","INVALID_OPTIONS");var t=o.keys(e),n=o.difference(t,A);if(n.length)throw l.create("Chat","INVALID_ARGUMENT");if(!e.room||!o.isObject(e.room))throw l.create("Chat","INVALID_ROOM");if(e.collapsed&&!o.isBoolean(e.collapsed))throw l.create("Chat","INVALID_COLLAPSED");if(e.container&&!o.isElement(e.container))throw l.create("Chat","INVALID_CONTAINER");if(e.position&&!o.contains(O,e.position))throw l.create("Chat","INVALID_POSITION");if(e.truncateLength&&!o.isNumber(e.truncateLength))throw l.create("Chat","INVALID_TRUNCATELENGTH");if(e.avatars&&!o.isBoolean(e.avatars))throw l.create("Chat","INVALID_AVATARS");var r=o.defaults(e,P);this._room=r.room,this._collapsed=r.collapsed,this._position=r.position,this._container=r.container,this._truncateLength=r.truncateLength,this._wrapper=null,this._chatWrapper=null,this._collapseBtn=null,this._messageList=null,this._messageInput=null,this._messageBtn=null,this._isBound=!1,this._userCache=new a(this._room),o.bindAll(this,["_handleCollapseToggle","_getMessages","_handleNewMessage"])}function B(){return(new Date).getTime()+"_"+Math.floor(Math.random()*999999999+1)}function j(e,t){var n="";if(e.length>t){var r=e.substring(0,t);return e[t]===" "?u(r):r+"..."}return n||e}var r=t("classes"),i=t("binder"),s=t("async"),o=t("lodash"),u=t("trim"),a=t("usercache"),f=t("colors-common"),l=t("./lib/errors"),c=t("./templates/list-template.html"),h=t("./templates/message-template.html"),p="gi-chat",d="gi-chat-wrapper",v="gi-message",m="gi-local-message",g="gi-message-list",y="gi-message-input",b="gi-message-btn",w="gi-override",E="gi-collapse",S="gi-anchor",x="gi-relative",T="gi-left",N="gi-right",C="collapsed",k=13,L=9,A=["room","collapsed","position","container","truncateLength","avatars"],O=["left","right"],M=/\/displayName$/,_=/\/avatarUrl$/,D=/^\/messages\/\d+_\d+$/,P={room:null,collapsed:!1,position:"right",container:null,truncateLength:10,avatars:!0};n.exports=H,H.prototype.initialize=function(e){if(!e||!o.isFunction(e))throw l.create("initialize","INVALID_CALLBACK");this._append(),this._messagesKey=this._room.key("/messages");var t=[o.bind(this._userCache.initialize,this._userCache),this._getMessages],n=this;s.series(t,function(t){if(t){n.destroy(function(){return e(t)});return}return i.on(n._collapseBtn,"click",n._handleCollapseToggle),n._isBound=!0,e(null,n)})},H.prototype._append=function(){this._wrapper=document.createElement("div"),this._wrapper.setAttribute("class",p+" "+w),this._wrapper.innerHTML=c,this._chatWrapper=this._wrapper.querySelector("."+d),this._messageList=this._wrapper.querySelector("."+g),this._messageInput=this._wrapper.querySelector("."+y),this._messageBtn=this._wrapper.querySelector("."+b),i.on(this._messageInput,"keydown",this._handleNewMessage),i.on(this._messageBtn,"click",this._handleNewMessage),this._container?(this._container.appendChild(this._wrapper),r(this._wrapper).add(x)):(document.body.appendChild(this._wrapper),r(this._wrapper).add(S)),this._collapseBtn=this._wrapper.querySelector("."+E),this._collapse(this._collapsed),!this._container&&this._position==="right"?r(this._wrapper).add(N):this._container||r(this._wrapper).add(T)},H.prototype._handleCollapseToggle=function(){this._collapse(!this._collapsed)},H.prototype._collapse=function(e){e?(r(this._chatWrapper).add(C),r(this._collapseBtn).add(C),this._collapsed=!0):(r(this._chatWrapper).remove(C),r(this._collapseBtn).remove(C),this._collapsed=!1,this._scrollChatToBottom())},H.prototype.sendMessage=function(e,t){var n={};n.text=o.escape(e),n.id=B(),n.user=this._userCache.getLocalUser();var r=this;this._messagesKey.key(n.id).set(n,function(e,i,s){if(e)return t(e);r._addMessage(n),r._messageInput.value="",t(null)})},H.prototype._handleNewMessage=function(e){var t=(e.keyCode===k||e.keyCode===L)&&e.type==="keydown",n=e.type==="click";if(!t&&!n)return;if(this._messageInput.value==="")return;this.sendMessage(this._messageInput.value,function(e){if(e)return})},H.prototype._getMessages=function(e){var t=this;this._messagesKey.get(function(n,r,i){if(n)return e(n);r=o.sortBy(r,function(e,t){return t});for(var s in r)t._addMessage(r[s]);e()}),this._messagesKey.on("set",{bubble:!0,listener:function(e,n){D.test(n.key)&&t._addMessage(e)}},function(e){})},H.prototype._addMessage=function(e){var t={id:e.id,shortName:j(e.user.displayName,this._truncateLength),avatarColor:e.user.avatarColor,avatarUrl:e.user.avatarUrl},n=o.template(h,t),i=document.createElement("li");i.innerHTML=n;var s=i.getElementsByClassName("gi-text")[0];e.text=o.unescape(e.text);var u=document.createTextNode(e.text);s.appendChild(u),i.title=e.user.displayName,i.id=e.id,i.setAttribute("data-goinstant-id",e.id),r(i).add(e.user.id),r(i).add(v);var a=this._userCache.getLocalUser();e.user.id===a.id&&r(i).add(m),this._messageList.appendChild(i),this._scrollChatToBottom()},H.prototype._scrollChatToBottom=function(){this._messageList.scrollTop=this._messageList.scrollHeight},H.prototype.destroy=function(e){if(!e||!o.isFunction(e))throw l.create("destroy","INVALID_CALLBACK");this._isBound&&(i.off(this._collapseBtn,"click",this._handleCollapseToggle),this._isBound=!1),this._wrapper&&(this._wrapper.parentNode.removeChild(this._wrapper),this._wrapper=null),this._userCache.destroy(e)}}),e.register("chat/lib/errors.js",function(e,t,n){"use strict";var r=n.exports=function(){},i={INVALID_CALLBACK:": Callback was not found or invalid",INVALID_OPTIONS:": Options was not found or invalid",INVALID_ARGUMENT:": Invalid argument passed",INVALID_ROOM:": Room was not found or invalid",INVALID_COLLAPSED:": collapsed value must be a boolean",INVALID_CONTAINER:": container must be a DOM element",INVALID_POSITION:': position can only be "right" or "left"',INVALID_TRUNCATELENGTH:": truncateLength can only be a number",INVALID_AVATARS:": avatars must be a boolean",INVALID_LISTENER:": Listener was not found or invalid",INVALID_EVENT:": Event was not found or invalid"};r.create=function(e,t){if(!e||!t||!i[t])throw new Error("That error type doesn't exist!");return new Error(e+""+i[t])}}),e.register("chat/templates/list-template.html",function(e,t,n){n.exports='<div class="gi-chat-wrapper">\n  <ul class="gi-message-list"></ul>\n  <div class="gi-message-form clearfix">\n    <input class="gi-message-input" type="text"/>\n    <button class="gi-message-btn">Send</button>\n  </div>\n</div>\n<div class="gi-collapse"><span></span></div>\n'}),e.register("chat/templates/message-template.html",function(e,t,n){n.exports='<div class="gi-color" style="background-color: <%- avatarColor %>;\n  <% if (avatarUrl) { %> background-image:url(\'<%- avatarUrl %>\'); <% } %>">\n</div>\n<div class="gi-name">\n  <%- shortName %>\n</div>\n<div class="gi-text"></div>\n'}),e.alias("lodash-lodash/index.js","chat/deps/lodash/index.js"),e.alias("lodash-lodash/dist/lodash.compat.js","chat/deps/lodash/dist/lodash.compat.js"),e.alias("lodash-lodash/index.js","lodash/index.js"),e.alias("stagas-binder/index.js","chat/deps/binder/index.js"),e.alias("stagas-binder/index.js","binder/index.js"),e.alias("component-event/index.js","stagas-binder/deps/event/index.js"),e.alias("component-delegate/index.js","stagas-binder/deps/delegate/index.js"),e.alias("discore-closest/index.js","component-delegate/deps/closest/index.js"),e.alias("discore-closest/index.js","component-delegate/deps/closest/index.js"),e.alias("component-matches-selector/index.js","discore-closest/deps/matches-selector/index.js"),e.alias("component-query/index.js","component-matches-selector/deps/query/index.js"),e.alias("discore-closest/index.js","discore-closest/index.js"),e.alias("component-event/index.js","component-delegate/deps/event/index.js"),e.alias("component-classes/index.js","chat/deps/classes/index.js"),e.alias("component-classes/index.js","classes/index.js"),e.alias("component-indexof/index.js","component-classes/deps/indexof/index.js"),e.alias("component-trim/index.js","chat/deps/trim/index.js"),e.alias("component-trim/index.js","trim/index.js"),e.alias("caolan-async/lib/async.js","chat/deps/async/lib/async.js"),e.alias("caolan-async/lib/async.js","chat/deps/async/index.js"),e.alias("caolan-async/lib/async.js","async/index.js"),e.alias("caolan-async/lib/async.js","caolan-async/index.js"),e.alias("goinstant-usercache/usercache.js","chat/deps/usercache/usercache.js"),e.alias("goinstant-usercache/usercache.js","chat/deps/usercache/index.js"),e.alias("goinstant-usercache/usercache.js","usercache/index.js"),e.alias("component-emitter/index.js","goinstant-usercache/deps/emitter/index.js"),e.alias("component-indexof/index.js","component-emitter/deps/indexof/index.js"),e.alias("lodash-lodash/index.js","goinstant-usercache/deps/lodash/index.js"),e.alias("lodash-lodash/dist/lodash.compat.js","goinstant-usercache/deps/lodash/dist/lodash.compat.js"),e.alias("caolan-async/lib/async.js","goinstant-usercache/deps/async/lib/async.js"),e.alias("caolan-async/lib/async.js","goinstant-usercache/deps/async/index.js"),e.alias("caolan-async/lib/async.js","caolan-async/index.js"),e.alias("goinstant-usercache/usercache.js","goinstant-usercache/index.js"),e.alias("goinstant-colors-common/colors.js","chat/deps/colors-common/colors.js"),e.alias("goinstant-colors-common/colors.js","chat/deps/colors-common/index.js"),e.alias("goinstant-colors-common/colors.js","colors-common/index.js"),e.alias("goinstant-colors-common/colors.js","goinstant-colors-common/index.js"),e.alias("chat/index.js","chat/index.js"),typeof exports=="object"?module.exports=e("chat"):typeof define=="function"&&define.amd?define(function(){return e("chat")}):(this[""],this.goinstant=this.goinstant||{},this.goinstant.widgets=this.goinstant.widgets||{},this.goinstant.widgets.Chat=e("chat"))})();